{% extends "main.html" %}
{% block head_extra %}
<link rel="stylesheet" href="{{ url_for('tools.static', filename='css/tools.css') }}">
{% endblock %}

{% block content %}
<div class="grid-bg"></div>
<div class="scan-lines"></div>

<section class="workspace workspace-layout">

  <!-- LEFT: TOOL LIBRARY -->
  <aside class="tool-library glass" id="toolLibrary">
    <div class="library-header">
      <h3>Tool Library</h3>
      <div class="search-box">
        <input id="toolSearch" type="text" placeholder="Search tools...">
        <!-- (icon purely decorative) -->
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.2-4.2M10.8 18.3a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
      </div>
    </div>

    <!-- Example categories; your backend can render real ones -->
    <div class="tool-categories" id="toolCategories">
      <div class="category-section">
        <div class="category-header">
          <div class="category-info">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="1.5"/></svg>
            <span>Reconnaissance</span>
          </div>
          <span class="category-count">5</span>
          <span class="category-arrow">â–¾</span>
        </div>
        <div class="category-tools active">
          <!-- Mark draggable in JS; data attributes feed node content -->
          <div class="tool-item" data-tool-key="subfinder" data-tool-name="subfinder" data-tool-type="recon" data-tool-time="~30s" data-tool-desc="Passive subdomain discovery">
            <div class="tool-icon">S</div>
            <div class="tool-info">
              <div class="tool-name">subfinder</div>
              <div class="tool-desc">Passive subdomain discovery</div>
            </div>
            <div class="tool-meta">
              <div class="tool-time">~30s</div>
              <div class="tool-type">Recon</div>
            </div>
          </div>

          <div class="tool-item" data-tool-key="dnsx" data-tool-name="dnsx" data-tool-type="recon" data-tool-time="~10s" data-tool-desc="DNS probe & resolve">
            <div class="tool-icon">D</div>
            <div class="tool-info">
              <div class="tool-name">dnsx</div>
              <div class="tool-desc">DNS probe & resolve</div>
            </div>
            <div class="tool-meta">
              <div class="tool-time">~10s</div>
              <div class="tool-type">Recon</div>
            </div>
          </div>

          <div class="tool-item" data-tool-key="httpx" data-tool-name="httpx" data-tool-type="recon" data-tool-time="~15s" data-tool-desc="Probe web services">
            <div class="tool-icon">H</div>
            <div class="tool-info">
              <div class="tool-name">httpx</div>
              <div class="tool-desc">Probe web services</div>
            </div>
            <div class="tool-meta">
              <div class="tool-time">~15s</div>
              <div class="tool-type">Recon</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Add more categories or render server-side -->
    </div>
  </aside>

  <!-- CENTER: CANVAS -->
  <main class="canvas-area">
    <div class="canvas-header">
      <h2>Workflow</h2>
      <div class="canvas-stats"><span id="zoomPct">100%</span></div>
    </div>

    <div class="canvas-container">
      <div class="canvas pannable" id="canvas">
        <svg class="connection-layer" id="connectionLayer"></svg>
        <div class="canvas-content" id="canvasContent">
          <div class="workflow-boxes" id="workflowBoxes"></div>
        </div>
      </div>
    </div>
  </main>

  <!-- RIGHT: TERMINAL -->
  <aside class="terminal-panel glass">
    <div class="terminal-header">
      <div class="terminal-controls">
        <div class="terminal-dot red"></div>
        <div class="terminal-dot yellow"></div>
        <div class="terminal-dot green"></div>
      </div>
      <div class="terminal-title">Console</div>
      <div class="terminal-status"><span class="status-dot"></span> idle</div>
    </div>
    <div class="terminal-content">
      <div class="terminal-output" id="terminalOutput"></div>
    </div>
  </aside>
</section>
{% endblock %}

{% block scripts_extra %}
<script src="{{ url_for('tools.static', filename='js/tools.js') }}"></script>
{% endblock %}
