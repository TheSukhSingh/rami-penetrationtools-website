{% extends "main.html" %}

{% block title %}{{ post.title }} — Hunter's Terminal{% endblock %}

{% block meta %}
  <link rel="canonical" href="{{ url_for('blog.detail', slug=post.slug, _external=True) }}">
  {% if post.summary %}<meta name="description" content="{{ post.summary }}">{% endif %}

  <meta property="og:type" content="article">
  <meta property="og:title" content="{{ post.og_title or post.title }}">
  {% if post.summary or post.og_description %}
    <meta property="og:description" content="{{ post.og_description or post.summary }}">
  {% endif %}
  <meta property="og:url" content="{{ url_for('blog.detail', slug=post.slug, _external=True) }}">
  {% if post.cover_path %}
    <meta property="og:image" content="{{ post.cover_path }}">
    <meta name="twitter:card" content="summary_large_image">
  {% else %}
    <meta name="twitter:card" content="summary">
  {% endif %}
  {% if is_preview %}<meta name="robots" content="noindex,nofollow">{% endif %}

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": {{ (post.og_title or post.title)|tojson }},
    "description": {{ (post.og_description or post.summary or '')|tojson }},
    "datePublished": {{ (post.published_at.isoformat() if post.published_at else '')|tojson }},
    "dateModified": {{ post.updated_at.isoformat()|tojson }},
    "image": {{ (post.cover_path or '')|tojson }},
    "mainEntityOfPage": {"@type":"WebPage","@id": {{ url_for('blog.detail', slug=post.slug, _external=True)|tojson }}},
    "author": {"@type":"Organization","name":"Hunter's Terminal"},
    "publisher": {"@type":"Organization","name":"Hunter's Terminal"}
  }
  </script>
{% endblock %}

{% block head_extra %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

  <style>
    /* Preserve code block whitespace, enable horizontal scroll for long lines */
pre, pre code { white-space: pre; }
pre { overflow-x: auto; }

/* Optional: a subtle “glass” look that matches your theme */
#post-body pre {
  background: rgba(0, 10, 18, 0.6);
  border: 1px solid rgba(0, 255, 224, 0.15);
  border-radius: 10px;
  padding: 14px 16px;
}

/* If any global reset had overridden code/pre, undo it */
code { white-space: pre-wrap; word-break: normal; }

  </style>


{% endblock %}

{% block content %}
<div class="grid-bg"></div>
<div class="scan-lines"></div>
<div class="particles" id="particles"></div>

<article class="container" style="padding-top: 80px; padding-bottom: 60px;">
  {% if is_preview %}
    <div class="glass" role="note" style="padding:12px; margin-bottom:16px;">Preview — not indexed</div>
  {% endif %}

  <header class="glass card-hover" style="padding: 24px; margin-bottom: 24px;">
    <h1 style="margin-bottom: 8px;">{{ post.title }}</h1>
    <p class="text-mute" style="color: var(--text-mute);">
      {% if post.published_at %}{{ post.published_at.strftime('%b %d, %Y') }} · {% endif %}
      {{ (post.reading_time or 1) }} min read
      {% if post.category %} · <a href="{{ url_for('blog.by_category', slug=post.category.slug) }}" class="text-cyan">{{ post.category.name }}</a>{% endif %}
    </p>
    {% if post.cover_path %}
      <figure class="glass glow-cyan" style="margin-top:16px; overflow:hidden;">
        <img src="{{ post.cover_path }}" alt="{{ post.cover_alt or ('Cover image for ' ~ post.title) }}"
             loading="eager" fetchpriority="high" style="width:100%; display:block; object-fit:cover;">
        {% if post.cover_alt %}<figcaption style="padding:8px 12px; color: var(--text-mute);">{{ post.cover_alt }}</figcaption>{% endif %}
      </figure>
    {% endif %}
  </header>

  <!-- <section class="glass card-hover" style="padding: 24px;"> -->
  <section class="prose prose-invert" id="post-body" style="padding: 24px;">
    {{ post.body_html | safe }}
  </section>

  {% if post.tags %}
  <footer style="margin-top: 16px;">
    <div style="display:flex; flex-wrap:wrap; gap:8px;">
      {% for t in post.tags %}
        <a class="glass-button" href="{{ url_for('blog.by_tag', slug=t.slug) }}">#{{ t.name }}</a>
      {% endfor %}
    </div>
  </footer>
  {% endif %}
</article>
{% endblock %}
